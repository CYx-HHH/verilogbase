### 10G接口

常见接口：
- MII     电平标准cmos33  单沿传输    SDR
- RGMII          cmos33   双沿传输   DDR

电平接口发展历史：最初8086芯片使用TTL5-0V，降压需要很长时间，使用三极管控制电平反转，压摆率很低
现在常用cmos33电平标准5/3V，常用cmos33，降压也很缓慢，电平翻转慢压摆率低。
特殊接口HSTL，高速电平标准，在DDR芯片中很常见.


XGMII，10千兆接口/万兆，把数据线扩展为32位，RXD；4bit控制线，RXC，以及32位发送线TXD，4bit控制线TXC。和各1位收发时钟线。共74根线。
    
    32  bit， RXD
    4   bit，  RXC
    1   bit，  RXCLK
    32  bit， TXD
    4   bit，  TXC
    1   bit，  TXCLK

并行接口带宽大，但速度跑不快，走线不能太长，于是发展为串行高速接口：gtx gtp gth/又叫RocketIO

古老的问题：FPGA--PHY。通过XGMII接口/74根线连接，单端长线会导致信号衰减，同时会导致信道偏斜很大（32根地址线不可能完美等长，当clk采集数据线时有的线信号还没到达，即不满足时序关系）。
对XGMII的升级，串化---XAUI，有4Lane，每个Lane有TXD，TXC，RXD，RXC，共20根线，4Lane共80根线，比XGMII少了很多线，但速度更快，走线更短，信号衰减更小，时序关系更好。

    0 - 7  bit---1 Lane
    8 - 15 bit---2 
    
    Lane
    16- 23 bit---3 Lane
    24- 31 bit---4 Lane
    ...

优点：走线可以很长，减少很多线，共20根线。


        XGMII      XAUI           XSBI
    MAC-------XGXS-------XGXS|PCS-------PMA|PMD---光纤介质
        |                                  |
        |-------------PHY层----------------|

XGXS：将XGMII和XAUI互相转换

PHY层：PCS+PMA

当前常用的形式，FPGA内部有PHY，使用gt收发器/PCS+PAM接到光纤-SFP传输，常见的万兆以太网的网卡也是走光纤，连PCIE插到电脑。
网络走10M光纤通信，数据给到网卡，网卡把数据转给PCIE。

gtx支持12.5Gbps，可以满足万兆以太网的传输速度，一直在发送消息。
gt差分接口，电平标准CML。缺点，延时大，不好对齐（位同步等）。



10gPCS-PMA/PHY，只有gt收发器和帧处理，只将接收到的数据恢复出来。不包含MAC层。PHY配置接口为mdio。

### 10g PCS/PMA，10gbase-r
内部包含gt收发器，选择64bit位宽（32位宽的时钟是64的两倍），要求提供的参考时钟为156.25Mhz。



### 64B66B编码
*在交流电路中，长连1和长连0会导致电容充放电，导致电流波动，产生辐射干扰。*

8B10B编码，将8bit数据做编码，目的是将长连1/0的情况消除掉，将其扩展为10bit新数据，效率为8/10。
最早用于200M串行通讯（最多5个长连1）。

10bit数据有1024种码型组合，挑选一些作为D码、K码（一一对应），K码是辅助传输的控制码，用来控制D码（数据）的连续性。
避免过大的长连1和长连0，也就是“直流平衡”。在交流信号中，直流分量为0，判断信号的准确率高。

为了提高比8B10B编码更高效的是64B66B编码，用于处理PHY层发送数据的编码。它不像8B10B编码采用真值表对原数据编码（每个编码后的数值都有对应的的原码值），
而是采用了加扰的方式让数据更接近白噪声（加扰编码/解扰解码，不分D码和K码），从而达到“直流平衡”的目的（不如8B10B）。

64B66B对64bit数据进行编码，变成66bit，增加了2bit的控制信息，保证了数据和时钟的连续性。

8B10B采用K码传输控制信息-同步头、开始、结束等；64B66B采用控制帧传输控制信息（64B66B有数据帧和控制帧两种）。

64B66B，在发送端PHY层将原始数据加扰，然后通过GT高速收发器发送出去，在接收端将GT接收的数据在PHY层解扰恢复。

加扰/解扰的实现采用线性反馈移位寄存器LFSR，通过异或操作实现；或采用多项式实现（X58+X19+1，或者X65+X18+1）.

实际传输信道中会增加信号的抖动和衰减。

### 64B66B数据帧格式

数据位扩展到66bit，前两位为控制位-表示当前数据帧传输的是什么信息，后64位是数据或控制信息。8bit序列为一个帧。

控制位：00-帧错误，01-纯数据帧，10-控制帧，11-帧错误。
数据为：SOF+DATA+EOF；一共有12种帧型，分别为传输1-8字节数据的8种帧，以及两种开始帧，一个结束帧，和一个纯控制帧-空闲帧或用于同步。
另一种开始帧-SOF在第4个字节开始。

控制帧主要为SOF和EOF，控制帧7bit，Z表示控制字符-可当作同步码使用，T代表EOF。


其他还有128B130B编码等。



